@Override
        public void run() {
            System.out.println("Work started on file : " + workOnFile.getAbsolutePath());
            BufferedReader reader = null;
            try {
                reader = new BufferedReader(new InputStreamReader(new FileInputStream(workOnFile)));
                String line = "";
                int lineCount = 0;
                while((line = reader.readLine()) != null) {
                    String[] split = line.split("\\|");
                    String busID = split[5];
                    String carNumber = split[0];
                    if(!sharedBusID_File_Map.containsKey(busID)) {
                        //createNewTableForBusID(busID);
                        ArrayList<String> initialList = new ArrayList<>();
                        initialList.add(workOnFile.getAbsolutePath());
                        sharedBusID_File_Map.put(busID, initialList);
                        System.out.println("Bus ID : " +  busID + "           Car Number : " + carNumber
                                + "   Bus Counter : " + uniqueBusCounter + " Shared Data Size : " + sharedBusID_File_Map.size()
                                + "   File NO : " + workOnFile + " LineCount : " + lineCount);
                        uniqueBusCounter++;
                        lineCount++;
                    } else if(sharedBusID_File_Map.containsKey(busID)) {
                        ArrayList<String> fileList = sharedBusID_File_Map.get(busID);
                        if(!fileList.contains(workOnFile.getAbsolutePath())) {
                            sharedBusID_File_Map.get(busID).add(workOnFile.getAbsolutePath());
                        }
                        lineCount++;
                    }
                    else {
                        lineCount++;
                    }
                }
            } catch(IOException e) {
                e.printStackTrace();
            }
            writeProcessedIndex();
        }

        private void writeProcessedIndex() {
            FileWriter writer = null;
            FileOutputStream outStream = null;
            try {
                writer = new FileWriter(BusID_FileLocation);

                Iterator<String> keySetIter = sharedBusID_File_Map.keySet().iterator();
                ArrayList<String> keyArray = new ArrayList<>();
                String key = "";
                while(keySetIter.hasNext()) {
                    key = keySetIter.next();
                    keyArray.add(key);
                }

                for(int i = 0; i < keyArray.size(); i++) {
                    writer.write(keyArray.get(i) + ",");
                    for(int j = 0; j < sharedBusID_File_Map.get(keyArray.get(i)).size(); j++) {
                        writer.write(sharedBusID_File_Map.get(keyArray.get(i)).get(j) + ",");
                    }
                    writer.write("\n");
                }
                writer.close();
            } catch(IOException e) {
                e.printStackTrace();
            }
        }